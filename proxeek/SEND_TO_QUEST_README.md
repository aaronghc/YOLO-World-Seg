# Send Optimization Results to Quest

This directory contains a standalone script for manually sending optimization results to your Meta Quest 3 device.

## Files

- **`send_results_to_quest.py`** - Python script that sends results to Quest
- **`send_to_quest.bat`** - Windows batch file for easy execution (double-click to run)

## Usage

### Method 1: Double-click (Windows)
Simply double-click `send_to_quest.bat` to send the latest optimization results to Quest.

### Method 2: Command Line
```bash
# Send default results file (output/optimization_results_for_quest.json)
python send_results_to_quest.py

# Send a custom results file
python send_results_to_quest.py path/to/custom_results.json
```

## Workflow

### Typical Usage Flow:
1. **Run optimization** to generate results:
   ```bash
   python ProXeek_Optimization.py
   ```
   This creates `output/optimization_results_for_quest.json`

2. **Send to Quest** when ready:
   - Double-click `send_to_quest.bat`, OR
   - Run `python send_results_to_quest.py`

### When to Use This Script
- After running `ProXeek_Optimization.py` when you want to manually trigger sending results
- When you want to re-send previous optimization results to Quest
- When testing different optimization results without re-running the full pipeline

## Requirements

### Prerequisites:
1. **Quest Server Running**: The local server must be running on `http://localhost:5000`
2. **Quest Device**: Meta Quest 3 must be powered on and connected
3. **Results File**: `optimization_results_for_quest.json` must exist in the `output` directory

### What the Script Does:
1. âœ… Loads `optimization_results_for_quest.json`
2. âœ… Validates the payload format
3. âœ… Displays a summary of assignments and spatial configuration
4. âœ… Sends the data to Quest via HTTP POST to `http://localhost:5000/send_to_quest`
5. âœ… Shows success/error messages with detailed feedback

## Output Format

The script expects the following JSON format (automatically generated by `ProXeek_Optimization.py`):

```json
{
  "action": "optimization_results",
  "data": [
    {
      "virtualObjectName": "Fork",
      "proxyObjectName": "black and silver retractable ballpoint pen",
      "utilizationMethod": "Wrap thumb and index finger..."
    }
  ],
  "pinPoint": [-0.813, 0.0, -1.844],
  "rotationAngle": -300.0,
  "timestamp": "uuid-string",
  "total_assignments": 2
}
```

## Troubleshooting

### Connection Errors
**Error**: `Could not connect to Quest server`

**Solutions**:
- Check that the Quest server is running on port 5000
- Verify the Quest device is powered on
- Ensure your network connection is active
- Try restarting the Quest server

### Timeout Errors
**Error**: `Request timed out after 10 seconds`

**Solutions**:
- The server might be overloaded - wait and try again
- Check server logs for errors
- Increase timeout in the script if needed (edit `REQUEST_TIMEOUT`)

### File Not Found
**Error**: `File not found: optimization_results_for_quest.json`

**Solutions**:
- Run `ProXeek_Optimization.py` first to generate the results file
- Check that you're in the correct directory
- Verify the `output` folder exists

## Configuration

You can modify these settings in `send_results_to_quest.py`:

```python
# Server endpoint (line 18)
QUEST_SERVER_URL = "http://localhost:5000/send_to_quest"

# Request timeout in seconds (line 19)
REQUEST_TIMEOUT = 10

# Default output directory (line 16)
DEFAULT_OUTPUT_DIR = os.path.join(os.path.dirname(os.path.abspath(__file__)), "output")
```

## Integration with ProXeek Pipeline

This script is designed to work as part of the ProXeek pipeline:

```
ProXeek_Optimization.py â†’ generates â†’ optimization_results_for_quest.json
                                              â†“
                              send_results_to_quest.py â†’ sends to â†’ Quest Device
```

**Note**: The original `ProXeek.py` automatically sends results to Quest. This standalone script is for cases where you:
- Only run the optimization step (`ProXeek_Optimization.py`)
- Want manual control over when to send results
- Need to re-send results without re-running optimization

## Example Output

```
============================================================
ProXeek - Send Optimization Results to Quest
============================================================

Using default results file: C:\...\proxeek\output\optimization_results_for_quest.json
âœ“ Loaded optimization results from: C:\...\output\optimization_results_for_quest.json

============================================================
Sending Optimization Results to Quest
============================================================

ðŸ“¦ Payload Summary:
   â€¢ Total assignments: 2
   â€¢ Timestamp: adef5df9-20b6-42f7-b168-45b49bdd74f6
   â€¢ Pin point: [-0.813, 0.000, -1.844]
   â€¢ Rotation angle: -300.0Â°

ðŸ“‹ Assignments:
   1. Fork â†’ black and silver retractable ballpoint pen
   2. Steak â†’ blue bulletin board panel

ðŸ”„ Sending to Quest server: http://localhost:5000/send_to_quest
   Timeout: 10 seconds

âœ… Successfully sent optimization results to Quest!
   HTTP Status: 200

============================================================
âœ… Operation completed successfully!
============================================================
```

